{% extends "base.html" %} {% block title %}{{ subject.title }}{% endblock %} {%
block content %}

{% include "subjects_navbar.html" %}

<div class="container mt-3">
  <div
    class="p-5 bg-blue-500 text-white rounded position-relative"
    style="height: 250px"
  >
    <h1 class="text-2xl font-semibold position-absolute bottom-0 start-0 m-3">
      {{ subject.title }}
    </h1>
  </div>
</div>

<div class="container mt-4">
  <div class="row">
    <div class="col-md-4">
      {% if subject.teacher_id == user.id %}
      <div class="card mb-3">
        <div class="card-header">Access Code</div>
        <div class="card-body">
          <input
            type="text"
            class="form-control mb-2"
            value="{{ subject.access_code }}"
            id="accessCode"
            readonly
          />
          <button
            class="btn btn-outline-secondary"
            type="button"
            onclick="copyAccessCode()"
          >
            Copy Code
          </button>
        </div>
      </div>
      {% endif %} {% if subject.meet_link %}
      <div class="card">
        <div class="card-header">
          Google Meet
        </div>
        <div class="card-body">
        
          <a
            href="{{ subject.meet_link }}"
            class="btn btn-primary w-100"
            target="_blank"
            >Join Meeting</a
          >
        </div>
      </div>
      {% endif %}
    </div>
    <div class="col-md-8">
       {% if subject.teacher_id == user.id %}
<div class="modal fade" id="createHomeworkModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Create Homework</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form method="POST" action="/tasks/create">
                <input type="hidden" name="subject_id" value="{{ subject.id }}">
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="hw_title" class="form-label">Title</label>
                        <input type="text" class="form-control" id="hw_title" name="title" required>
                    </div>
                    <div class="mb-3">
                        <label for="hw_description" class="form-label">Description</label>
                        <textarea class="form-control" id="hw_description" name="description" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="hw_deadline" class="form-label">Deadline</label>
                        <input type="datetime-local" class="form-control" id="hw_deadline" name="deadline" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Create</button>
                </div>
            </form>
        </div>
    </div>
</div>


{% endif %}
<div class="grid grid-cols-1 gap-4">
    {% for item in tasks %}
    <div class="bg-white p-4 h-16 rounded-lg shadow-sm border hover:shadow-lg cursor-pointer" onclick="window.location.href='/tasks/task/{{ item.id }}'">
        <h5 class="text-lg font-semibold">{{ item.title if item.title else 'Announcement' }}: {{ item.description if item.description else 'Homework Task' }}</h5>
    </div>  
    {% endfor %}
  </div>
  
    </div>
  </div>
</div>

<script>
  function copyAccessCode() {
    const codeInput = document.getElementById("accessCode");
    codeInput.select();
    document.execCommand("copy");
    alert("Access code copied!");
  }
</script>
{% endblock %}
